import{initializeApp}from"https://www.gstatic.com/firebasejs/9.9.3/firebase-app.js";import{getFirestore,collection,addDoc,getDocs,query,where,doc,deleteDoc,getDoc,orderBy,Timestamp}from"https://www.gstatic.com/firebasejs/9.9.3/firebase-firestore.js";import{getStorage,ref,uploadBytesResumable,deleteObject}from"https://www.gstatic.com/firebasejs/9.9.3/firebase-storage.js";const firebaseConfig={apiKey:"AIzaSyDIddKsbkz8MpqQX3sIjtAozy6_UmlU7bQ",authDomain:"reverb-web-app.firebaseapp.com",projectId:"reverb-web-app",storageBucket:"reverb-web-app.appspot.com",messagingSenderId:"782158261364",appId:"1:782158261364:web:8d61d0530f47f4a3bcf521"},app=initializeApp(firebaseConfig),db=getFirestore(app),storage=getStorage();export const addMusic=(e,t)=>{const r=(new Date).getTime().toString()+(Math.random()+1).toString(36).substring(10),o=ref(storage,`music/${r}.${t}`);return uploadBytesResumable(o,e)};export const newMusic=({uid:e,title:t,url:r,reference:o})=>addDoc(collection(db,"music"),{uid:e,title:t,url:r,reference:o,date:Timestamp.fromDate(new Date)});const mapMusic=e=>({...e.data(),id:e.id});export const getMusic=e=>getDocs(query(collection(db,"music"),where("uid","==",e),orderBy("date"))).then((({docs:e})=>e.map(mapMusic)));export const deleteMusic=e=>getDoc(doc(db,"music",e)).then((t=>{const{reference:r}=t.data();return deleteDoc(doc(db,"music",e)).then((()=>deleteObject(ref(storage,r))))}));
